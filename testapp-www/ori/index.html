<!doctype html>
<html>
  <head>
    <title>CoCoVo</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://apis.google.com/js/client.js" async defer></script>
    <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
    <meta name="google-signin-client_id" content="111843660877-2aahjqbvq8k53f7odc3t4p1e9sdkpdie.apps.googleusercontent.com">
    <style>
    </style>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">CoCoVo</a>
        </div>
        <div class="navbar-collapse collapse">
          <form class="navbar-form navbar-right" role="form">
            <div class="form-group" style="display:None">
              <input id="user-name" type="text" placeholder="Name" class="form-control">
              <input id="user-age" type="text" placeholder="Age" class="form-control">
              <input id="user-email" type="text" placeholder="Email" class="form-control">
              <button id="sign-in" type="submit" class="btn btn-success">Sign in</button>
            </div>
              <div align="right" id="gSignInButton" class="g-signin2" data-onsuccess="onSignIn"></div>
            <div id="gSignOutButton" style="display:None">
             <a href="#" onclick="signOut();" style="align:right">Sign out</a>
            <img src="" id="user_image" alt="pic" height="42" width="42" align"right"/>
            </div>
          </form>
        </div><!--/.navbar-collapse -->
      </div>
    </div>

    <!--<div class="jumbotron">
      <div class="container">
        <h1>Your Adaptive Vocabulary Application</h1>
        <p>Click the button below to begin</p>
        <p><a class="btn btn-primary btn-lg" id="begin" type="submit" >Begin &raquo;</a></p>
      </div>
    </div>-->

       <div class="container">
      <!-- Example row of columns -->
      <div class="row">
        <h1>Words of the day</h1>
        <div class="col-md-4">
          <h2>Hello</h2>
          <p>A form of expression</p>
          <!--<p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>-->
        </div>
        <div class="col-md-4">
          <h2>Mesmerize</h2>
          <p>Capture the complete attention of (someone); transfix.</p>
          <!--<p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>-->
       </div>
        <div class="col-md-4">
          <h2>Denigrate</h2>
          <p>Criticize unfairly; disparage.</p>
          <!--<p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>-->
        </div>
		
		
		 <style>
	  * {
		font-family: Verdana, Arial, sans-serif;
	  }
	  a:link {
		color:#000;
		text-decoration: none;
	  }
	  a:visited {
		color:#000;
	  }
	  a:hover {
		color:#33F;
	  }
	  .button {
		background: -webkit-linear-gradient(top,#008dfd 0,#0370ea 100%);
		border: 1px solid #076bd2;
		border-radius: 3px;
		color: #fff;
		display: none;
		font-size: 13px;
		font-weight: bold;
		line-height: 1.3;
		padding: 8px 25px;
		text-align: center;
		text-shadow: 1px 1px 1px #076bd2;
		letter-spacing: normal;
	  }
	  .center {
		padding: 10px;
		text-align: center;
	  }
	  .final {
		color: black;
		padding-right: 3px; 
	  }
	  .interim {
		color: gray;
	  }
	  .info {
		font-size: 14px;
		text-align: center;
		color: #777;
		display: none;
	  }
	  .right {
		float: right;
	  }
	  .sidebyside {
		display: inline-block;
		width: 45%;
		min-height: 40px;
		text-align: left;
		vertical-align: top;
	  }
	  #headline {
		font-size: 40px;
		font-weight: 300;
	  }
	  #info {
		font-size: 20px;
		text-align: center;
		color: #777;
		visibility: hidden;
	  }
	  #results {
		font-size: 14px;
		font-weight: bold;
		border: 1px solid #ddd;
		padding: 15px;
		text-align: left;
		min-height: 150px;
	  }
	  #start_button {
		border: 0;
		background-color:transparent;
		padding: 0;
	  }
	</style>
	<h1 class="center" id="headline">
	  <a href="http://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html">
		Web Speech API</a> Demonstration</h1>
	<div id="info">
	  <p id="info_start">Click on the microphone icon and begin speaking.</p>
	  <p id="info_speak_now">Speak now.</p>
	  <p id="info_no_speech">No speech was detected. You may need to adjust your
		<a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
		  microphone settings</a>.</p>
	  <p id="info_no_microphone" style="display:none">
		No microphone was found. Ensure that a microphone is installed and that
		<a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
		microphone settings</a> are configured correctly.</p>
	  <p id="info_allow">Click the "Allow" button above to enable your microphone.</p>
	  <p id="info_denied">Permission to use microphone was denied.</p>
	  <p id="info_blocked">Permission to use microphone is blocked. To change,
		go to chrome://settings/contentExceptions#media-stream</p>
	  <p id="info_upgrade">Web Speech API is not supported by this browser.
		 Upgrade to <a href="//www.google.com/chrome">Chrome</a>
		 version 25 or later.</p>
	</div>
	<div class="right">
	  <button id="start_button" onclick="startButton(event)">
		<img id="start_img" src="mic.gif" alt="Start"></button>
	</div>
	<div id="results">
	  <span id="final_span" class="final"></span>
	  <span id="interim_span" class="interim"></span>
	  <p>
	</div>
	<div class="center">
	  <div class="sidebyside" style="text-align:right">
		<button id="copy_button" class="button" onclick="copyButton()">
		  Copy and Paste</button>
		<div id="copy_info" class="info">
		  Press Control-C to copy text.<br>(Command-C on Mac.)
		</div>
	  </div>
	  <div class="sidebyside">
		<button id="email_button" class="button" onclick="emailButton()">
		  Create Email</button>
		<div id="email_info" class="info">
		  Text sent to default email application.<br>
		  (See chrome://settings/handlers to change.)
		</div>
	  </div>
	  <p>
	  <div id="div_language">
		<select id="select_language" onchange="updateCountry()"></select>
		&nbsp;&nbsp;
		<select id="select_dialect"></select>
	  </div>
	</div>
          
          
        <div id="foo" class="col-md-4">
          <div id="chatbar">
          <b>Questions? Ask here</b>
          </div>
          <div>
            <textarea class="form-control" id="older-messages" rows="5" readonly></textarea>
            <textarea class="form-control" id="message" rows="1" placeholder="Type your queries here"></textarea>
            <input type="hidden" id="message-id" value="null"/>
          </div>
          <div>
            <button type="submit" id="send-message" class="btn btn-default">Send</button>
          </div>
        </div>
      </div>
      
      <div class="container">
      <!--div for new layout of questions -->
              <div class="container-fluid bg-info">
            <div class="modal-dialog">
              <div class="modal-content">
                 <div class="modal-header">
                 <h3 href="#"><a>Level:<span class="label label-warning" id="lid"></span></a></h3>
                    <a><h3 id="qs" href="#">Click Begin to Start Test</h3></a>
                </div>
                <div class="modal-body">
                    <div class="col-xs-3 col-xs-offset-5">
                       <div id="loadbar" style="display: none;">
                          <div class="blockG" id="rotateG_01"></div>
                          <div class="blockG" id="rotateG_02"></div>
                          <div class="blockG" id="rotateG_03"></div>
                          <div class="blockG" id="rotateG_04"></div>
                          <div class="blockG" id="rotateG_05"></div>
                          <div class="blockG" id="rotateG_06"></div>
                          <div class="blockG" id="rotateG_07"></div>
                          <div class="blockG" id="rotateG_08"></div>
                      </div>
                  </div>
        
                  <div class="quiz" id="quiz" data-toggle="buttons">
                   <label class="element-animation1 btn btn-lg btn-primary btn-block"><span class="btn-label"><i class="glyphicon glyphicon-chevron-right"></i></span><input type="radio" name="q_answer" value="1">TRUE</label>
                   <label class="element-animation2 btn btn-lg btn-primary btn-block"><span class="btn-label"><i class="glyphicon glyphicon-chevron-right"></i></span><input type="radio" name="q_answer" value="0">FALSE</label>
                  <!-- <label class="element-animation3 btn btn-lg btn-primary btn-block"><span class="btn-label"><i class="glyphicon glyphicon-chevron-right"></i></span> <input type="radio" name="q_answer" value="0">3 Three</label>-->
                  <!-- <label class="element-animation4 btn btn-lg btn-primary btn-block"><span class="btn-label"><i class="glyphicon glyphicon-chevron-right"></i></span> <input type="radio" name="q_answer" value="0">4 Four</label>-->
               </div>
           </div>
           <div class="modal-footer text-muted">
            <span id="answer"></span>
        </div>
        </div>
        </div>
        </div>
        <!--END of div for new layout of questions -->
     </div>
		 
		 

     

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.0/jquery.cookie.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="http://localhost:8000/static/cocovo.js"></script>
    <script src="http://localhost:8000/static/cocovolayout.js"></script>
    
    
    <!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>-->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.js"></script>
    <link type="text/css" href="http://localhost:8000/static/jquery.ui.chatbox.css" rel="stylesheet" />
    <link type="text/css" href="http://localhost:8000/static/cocovolayout.css" rel="stylesheet" />
    <script type="text/javascript" src="http://localhost:8000/static/jquery.ui.chatbox.js"></script>
    <style>
      #foo {
        position: fixed;
        bottom: 0;
        right:  0;
        width: 15%;
      }
      #chatbar {
        background-color: #83de5b57;
      }
    </style>
    <script language="javascript">
      $('#message').keypress(function (e) {
          if (e.which == 13) {
            Cocovo.send_admin($.cookie('user'), $('#message').val(),$('#message-id').val());
            alert($('#message').val());
            return false;
          }
        });
      // Set logged-in user email.
      $(function() {
        var currentUser = $.cookie('user');
        if (currentUser) {
          $('#user-email').val(currentUser);
        }
      });

      // Sign-in.
      $(function() {
        $('#sign-in').click(function(event) {
          event.preventDefault();
          $.cookie('user', $('#user-email').val())
          Cocovo.register($.cookie('user'),$('#user-name').val(),$('#user-age').val());
        });
        
        $("label.btn").on('click',function () {
        	var choice = $(this).find('input:radio').val();
        	$('#loadbar').show();
        	$('#quiz').fadeOut();
        	setTimeout(function(){
                $( "#answer" ).html(  $(this).checking(choice) );      
                $('#quiz').show();
                $('#loadbar').fadeOut();
               /* something else */
               //event.preventDefault();
               end = Date.now();  
               var elapsed = (end - start) / 1000;  
               alert("You took " + Math.round(elapsed) + " seconds" + " to type: ");  
               Cocovo.send_admin($.cookie('user'), choice,$('#message-id').val(), Math.round(elapsed));
               start = Date.now();
        	}, 1500);
        });
        
        $ans = 1;

        $.fn.checking = function(ck) {
        if (ck != $ans)
            return 'INCORRECT';
        else 
            return 'CORRECT';
        }; 
        
        $('#send-message').click(function(event) {
          event.preventDefault();
          Cocovo.send_admin($.cookie('user'), $('#message').val(),$('#message-id').val());
        });
      });

      // Register with Cocovo.
      $(function() {
        if ($.cookie('user')) {
          //alert("hello5");
          Cocovo.register($.cookie('user'), null,null);
        }
      });
      
      function onSignIn(googleUser) {
      $('#gSignInButton').css('display','none');
      $('#gSignOutButton').css('display','true');
      var profile = googleUser.getBasicProfile();
      //alert(profile.getId());
      console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
      console.log('Name: ' + profile.getName());
      console.log('Image URL: ' + profile.getImageUrl());
      $.cookie('user', profile.getEmail())
      
      start = Date.now();  
      Cocovo.register($.cookie('user'),profile.getName(),25);
      $('#user_image').attr("src", profile.getImageUrl());
      console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
      
      gapi.client.load('plus','v1', function(){
     var request = gapi.client.plus.people.get({
       'userId': 'me'
     });
     request.execute(function(resp) {
         alert(resp.gender);
         if(resp.gender=="male")
             //$("body").css("background-color","blue");
             $("body").css('background-image', 'url("http://i63.tinypic.com/29gn3bn.jpg")');
         console.log('age range: ' + resp.isPlusUser);
         alert(resp.birthday);
       console.log('Retrieved profile for:' + resp.displayName);
     });
});
    }
    
      function signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.disconnect().then(function () { //use auth2.signOut() for app level signout
          $('#gSignInButton').css('display','true');
          $('#gSignOutButton').css('display','none');
          $.cookie("user", null, { path: '/' });
          location.reload();
          console.log('User signed out.');
        });
      }
     
    </script>

    <script src='//vws.responsivevoice.com/v/e?key=AjoOLINh'></script>
    	<script>
	var langs =
	[['Afrikaans',       ['af-ZA']],
	 ['Bahasa Indonesia',['id-ID']],
	 ['Bahasa Melayu',   ['ms-MY']],
	 ['Català',          ['ca-ES']],
	 ['Čeština',         ['cs-CZ']],
	 ['Deutsch',         ['de-DE']],
	 ['English',         ['en-AU', 'Australia'],
						 ['en-CA', 'Canada'],
						 ['en-IN', 'India'],
						 ['en-NZ', 'New Zealand'],
						 ['en-ZA', 'South Africa'],
						 ['en-GB', 'United Kingdom'],
						 ['en-US', 'United States']],
	 ['Español',         ['es-AR', 'Argentina'],
						 ['es-BO', 'Bolivia'],
						 ['es-CL', 'Chile'],
						 ['es-CO', 'Colombia'],
						 ['es-CR', 'Costa Rica'],
						 ['es-EC', 'Ecuador'],
						 ['es-SV', 'El Salvador'],
						 ['es-ES', 'España'],
						 ['es-US', 'Estados Unidos'],
						 ['es-GT', 'Guatemala'],
						 ['es-HN', 'Honduras'],
						 ['es-MX', 'México'],
						 ['es-NI', 'Nicaragua'],
						 ['es-PA', 'Panamá'],
						 ['es-PY', 'Paraguay'],
						 ['es-PE', 'Perú'],
						 ['es-PR', 'Puerto Rico'],
						 ['es-DO', 'República Dominicana'],
						 ['es-UY', 'Uruguay'],
						 ['es-VE', 'Venezuela']],
	 ['Euskara',         ['eu-ES']],
	 ['Français',        ['fr-FR']],
	 ['Galego',          ['gl-ES']],
	 ['Hrvatski',        ['hr_HR']],
	 ['IsiZulu',         ['zu-ZA']],
	 ['Íslenska',        ['is-IS']],
	 ['Italiano',        ['it-IT', 'Italia'],
						 ['it-CH', 'Svizzera']],
	 ['Magyar',          ['hu-HU']],
	 ['Nederlands',      ['nl-NL']],
	 ['Norsk bokmål',    ['nb-NO']],
	 ['Polski',          ['pl-PL']],
	 ['Português',       ['pt-BR', 'Brasil'],
						 ['pt-PT', 'Portugal']],
	 ['Română',          ['ro-RO']],
	 ['Slovenčina',      ['sk-SK']],
	 ['Suomi',           ['fi-FI']],
	 ['Svenska',         ['sv-SE']],
	 ['Türkçe',          ['tr-TR']],
	 ['български',       ['bg-BG']],
	 ['Pусский',         ['ru-RU']],
	 ['Српски',          ['sr-RS']],
	 ['한국어',            ['ko-KR']],
	 ['中文',             ['cmn-Hans-CN', '普通话 (中国大陆)'],
						 ['cmn-Hans-HK', '普通话 (香港)'],
						 ['cmn-Hant-TW', '中文 (台灣)'],
						 ['yue-Hant-HK', '粵語 (香港)']],
	 ['日本語',           ['ja-JP']],
	 ['Lingua latīna',   ['la']]];

	for (var i = 0; i < langs.length; i++) {
	  select_language.options[i] = new Option(langs[i][0], i);
	}
	select_language.selectedIndex = 6;
	updateCountry();
	select_dialect.selectedIndex = 6;
	showInfo('info_start');

	function updateCountry() {
	  for (var i = select_dialect.options.length - 1; i >= 0; i--) {
		select_dialect.remove(i);
	  }
	  var list = langs[select_language.selectedIndex];
	  for (var i = 1; i < list.length; i++) {
		select_dialect.options.add(new Option(list[i][1], list[i][0]));
	  }
	  select_dialect.style.visibility = list[1].length == 1 ? 'hidden' : 'visible';
	}

	var create_email = false;
	var final_transcript = '';
	var recognizing = false;
	var ignore_onend;
	var start_timestamp;
	if (!('webkitSpeechRecognition' in window)) {
	  upgrade();
	} else {
	  start_button.style.display = 'inline-block';
	  var recognition = new webkitSpeechRecognition();
	  recognition.continuous = false;
	  recognition.interimResults = false;

	  recognition.onstart = function() {
		recognizing = true;
		showInfo('info_speak_now');
		start_img.src = 'mic-animate.gif';
	  };

	  recognition.onerror = function(event) {
		if (event.error == 'no-speech') {
		  start_img.src = 'mic.gif';
		  showInfo('info_no_speech');
		  ignore_onend = true;
		}
		if (event.error == 'audio-capture') {
		  start_img.src = 'mic.gif';
		  showInfo('info_no_microphone');
		  ignore_onend = true;
		}
		if (event.error == 'not-allowed') {
		  if (event.timeStamp - start_timestamp < 100) {
			showInfo('info_blocked');
		  } else {
			showInfo('info_denied');
		  }
		  ignore_onend = true;
		}
	  };

	  recognition.onend = function() {
		recognizing = false;
		if (ignore_onend) {
		  return;
		}
		start_img.src = 'mic.gif';
		if (!final_transcript) {
		  showInfo('info_start');
		  return;
		}
		showInfo('');
		if (window.getSelection) {
		  window.getSelection().removeAllRanges();
		  var range = document.createRange();
		  range.selectNode(document.getElementById('final_span'));
		  window.getSelection().addRange(range);
		}
		if (create_email) {
		  create_email = false;
		  createEmail();
		}
	  };

	  recognition.onresult = function(event) {
		var interim_transcript = '';
		for (var i = event.resultIndex; i < event.results.length; ++i) {
		  if (event.results[i].isFinal) {
			final_transcript += event.results[i][0].transcript;
		  } else {
			interim_transcript += event.results[i][0].transcript;
		  }
		}
		final_transcript = capitalize(final_transcript);
		final_span.innerHTML = linebreak(final_transcript);
		interim_span.innerHTML = linebreak(interim_transcript);
		if (final_transcript || interim_transcript) {
		  alert(final_transcript);
		  if(final_transcript.includes("true") || final_transcript.includes("correct") || final_transcript.includes("right") || final_transcript.includes("yes") )
		  {
			var msg = new SpeechSynthesisUtterance('That\'s correct');
			window.speechSynthesis.speak(msg);
		  }
		  showButtons('inline-block');
		}
	  };
	}

	function upgrade() {
	  start_button.style.visibility = 'hidden';
	  showInfo('info_upgrade');
	}

	var two_line = /\n\n/g;
	var one_line = /\n/g;
	function linebreak(s) {
	  return s.replace(two_line, '<p></p>').replace(one_line, '<br>');
	}

	var first_char = /\S/;
	function capitalize(s) {
	  return s.replace(first_char, function(m) { return m.toUpperCase(); });
	}

	function createEmail() {
	  var n = final_transcript.indexOf('\n');
	  if (n < 0 || n >= 80) {
		n = 40 + final_transcript.substring(40).indexOf(' ');
	  }
	  var subject = encodeURI(final_transcript.substring(0, n));
	  var body = encodeURI(final_transcript.substring(n + 1));
	  window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
	}

	function copyButton() {
	  if (recognizing) {
		recognizing = false;
		recognition.stop();
	  }
	  copy_button.style.display = 'none';
	  copy_info.style.display = 'inline-block';
	  showInfo('');
	}

	function emailButton() {
	  if (recognizing) {
		create_email = true;
		recognizing = false;
		recognition.stop();
	  } else {
		createEmail();
	  }
	  email_button.style.display = 'none';
	  email_info.style.display = 'inline-block';
	  showInfo('');
	}

	function startButton(event) {
	  if (recognizing) {
		recognition.stop();
		return;
	  }
	  final_transcript = '';
	  recognition.lang = select_dialect.value;
	  recognition.start();
	  ignore_onend = false;
	  final_span.innerHTML = '';
	  interim_span.innerHTML = '';
	  start_img.src = 'mic-slash.gif';
	  showInfo('info_allow');
	  showButtons('none');
	  start_timestamp = event.timeStamp;
	}

	function showInfo(s) {
	  if (s) {
		for (var child = info.firstChild; child; child = child.nextSibling) {
		  if (child.style) {
			child.style.display = child.id == s ? 'inline' : 'none';
		  }
		}
		info.style.visibility = 'visible';
	  } else {
		info.style.visibility = 'hidden';
	  }
	}

	var current_style;
	function showButtons(style) {
	  if (style == current_style) {
		return;
	  }
	  current_style = style;
	  copy_button.style.display = style;
	  email_button.style.display = style;
	  copy_info.style.display = 'none';
	  email_info.style.display = 'none';
	}

	var msg = new SpeechSynthesisUtterance('Your adaptive vocabulary learning app!');
	window.speechSynthesis.speak(msg);
	speechSynthesis.getVoices().forEach(function(voice) {
	console.log('hello');
	  console.log(voice.name, voice.default ? voice.default :'');
	});
	</script>
  </body>
</html>